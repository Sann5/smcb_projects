---
title: "Project 1. Solution"
author: "Santiago Castro Dau, June Monge, Rachita Kumar, Sarus"
date: "2/25/2022"
output: pdf_document
---

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(vroom)
library(BiDAG)
```

## Problem 1: Conditional independence and BNs
\subsection*{a)}
The condition $A \perp B|C$ holds for this Bayesian network a).
Proof:
\begin{equation*}
\begin{split}
    P(A,B,C) &= P(A|C)P(B|C)P(C)\\
    \textnormal{Consider}\\
    P(A,B|C) &= \frac{P(A,B,C)}{P(C)}\\
    &=P(A|C)P(B|C)\\
    &\implies A\perp B|C\\
\end{split} 
\end{equation*}
Hence Proved.
\subsection*{b)}
The condition $A \perp B$ holds for this Bayesian network b).
Proof:
\begin{equation*}
\begin{split}
    P(A,B,C) &= P(A)P(B)P(C|A,B)\\
    P(C|A,B) &= \frac{P(A,B,C)}{P(A,B)}\\
    \textnormal{Substituting}\\
    P(A,B) &= P(A)P(B)\\    
    &\implies A\perp B\\
\end{split} 
\end{equation*}
Hence Proved.

## Problem 2: Markov blanket

## Problem 3: Learning Bayesian networks from protein data
### a)
```{r}
## Set seed
set.seed(2022)

## Read data
data <- vroom(file = "sachs.data.txt", show_col_types = FALSE)

## Visualize data dimensions. 
dim(data)
```

* $N = 853$
* $n = 11$

```{r}
## Split data
data = data %>% rowid_to_column(var = 'row_id')
train = data %>% sample_frac(0.8, replace = FALSE)
test = anti_join(data, train, by = "row_id")

## Initializing socre object
score_object = scoreparameters(scoretype = 'bge', train)
```

