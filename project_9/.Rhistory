knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("pcalg")
library("BiDAG")
#Read in dataset
set.seed(0)
DAG<-readRDS("./MVN_DAG.rds", refhook = NULL)
#Read in dataset
set.seed(0)
DAG<-readRDS("./MVN_DAG.rds", refhook = NULL)
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("pcalg")
library("BiDAG")
#Read in dataset
set.seed(0)
DAG<-readRDS("./MVN_DAG.rds", refhook = NULL)
#Create the scatterplot
slr.coef<-coef(lm(B~ A,DAG))
qplot(A,B,data=DAG)+theme_classic()+geom_abline(intercept =slr.coef[1], slope = slr.coef[2],colour="blue" )+ ggtitle("Marginal Coorelation")
#Coorelation Test
cor.test(DAG$A,DAG$B)
regA_C<-lm(A~ C,as.data.frame(DAG))
residualA_C<-residuals(regA_C)
regB_C<-lm(B~ C,as.data.frame(DAG))
residualB_C<-residuals(regB_C)
slr.coef<-coef(lm(residualB_C~ residualA_C))
qplot(residualA_C,residualB_C)+theme_classic()+geom_abline(intercept =slr.coef[1], slope = slr.coef[2],colour="blue" )+ ggtitle("Partial Correlation ")+labs(y= "B  | C", x = "A | C")
#Coorelation Test
cor.test(residualA_C,residualB_C)
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
param<-scoreparameters(scoretype="bge", DAG, bgepar = list(am = 0.05, aw = NULL))
partmcmc<-partitionMCMC(param)
param<-scoreparameters(scoretype="bge", DAG, bgepar = list(am = 0.05, aw = 0.05))
partmcmc<-partitionMCMC(param)
?scoreparameters
param<-scoreparameters(scoretype="bge", DAG, bgepar = list(am = 1, aw = NULL))
partmcmc<-partitionMCMC(param)
param<-scoreparameters(scoretype="bge", DAG)
partmcmc<-partitionMCMC(param)
#Read in dataset
set.seed(0)
DAG<-readRDS("./MVN_DAG.rds", refhook = NULL)
DAG
## Set seed
set.seed(2022)
## Read and index data
data <- vroom(file = "sachs.data.txt", show_col_types = FALSE)
library(vroom)
## Set seed
set.seed(2022)
## Read and index data
data <- vroom(file = "sachs.data.txt", show_col_types = FALSE)
data = data %>% rowid_to_column(var = 'row_id')
library(dplyr)
## Set seed
set.seed(2022)
## Read and index data
data <- vroom(file = "sachs.data.txt", show_col_types = FALSE)
data = data %>% rowid_to_column(var = 'row_id')
library(tidyverse)
## Set seed
set.seed(2022)
## Read and index data
data <- vroom(file = "sachs.data.txt", show_col_types = FALSE)
data = data %>% rowid_to_column(var = 'row_id')
## Visualize data dimensions.
dim(data)
data
param<-scoreparameters(scoretype="bge", DAG, bgepar = list(am = 0.05, aw = NULL))
param
?partitionMCMC
param<-scoreparameters(scoretype="bge", DAG)
partmcmc<-partitionMCMC(param)
plot(m2graph(partmcmc$DAG), main="Partition MCMC Algorithm Graph")
param<-scoreparameters(scoretype="bge", DAG)
partmcmc<-partitionMCMC(param)
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("pcalg")
library("ggplot2")
library("pcalg")
install.packages('RBGL')
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("RBGL")
library("ggplot2")
library("pcalg")
library("BiDAG")
library("ggplot2")
library("pcalg")
library("BiDAG")
#Read in dataset
set.seed(0)
DAG<-readRDS("./MVN_DAG.rds", refhook = NULL)
#Create the scatterplot
slr.coef<-coef(lm(B~ A,DAG))
qplot(A,B,data=DAG)+theme_classic()+geom_abline(intercept =slr.coef[1], slope = slr.coef[2],colour="blue" )+ ggtitle("Marginal Coorelation")
#Coorelation Test
cor.test(DAG$A,DAG$B)
regA_C<-lm(A~ C,as.data.frame(DAG))
residualA_C<-residuals(regA_C)
slr.coef<-coef(lm(residualB_C~ residualA_C))
regB_C<-lm(B~ C,as.data.frame(DAG))
residualB_C<-residuals(regB_C)
slr.coef<-coef(lm(residualB_C~ residualA_C))
qplot(residualA_C,residualB_C)+theme_classic()+geom_abline(intercept =slr.coef[1], slope = slr.coef[2],colour="blue" )+ ggtitle("Partial Correlation ")+labs(y= "B  | C", x = "A | C")
#Coorelation Test
cor.test(residualA_C,residualB_C)
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
class(pc)
help(pc)
library(pcalg)
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
gc()
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
sSt <- list(C = cor(DAG),n= nrow(DAG))
PCrun<-pc(suffStat=sSt,indepTest = gaussCItest,labels = colnames(DAG), alpha = 0.01)
plot(PCrun,main="PC Graph")
